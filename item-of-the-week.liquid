{%- liquid
  assign product = section.settings.product
  assign subtitle = section.settings.subtitle
  assign current_variant = product.selected_or_first_available_variant
-%}

<section class="iotw-section-minimal">
  <div class="iotw-container">
    
    {%- if section.settings.heading != blank -%}
      <div class="iotw-header">
        <h2 class="iotw-title-clean">{{ section.settings.heading | upcase }}</h2>
      </div>
    {%- endif -%}

    {%- if product != blank -%}
      <div class="iotw-main-grid">
        
        <div class="iotw-visuals">
          <div class="iotw-thumbnails-vertical">
            {%- for image in product.images limit: 4 -%}
              <div class="thumb-wrapper" onclick="switchImage('{{ image | image_url: width: 1000 }}', '{{ section.id }}')">
                <img src="{{ image | image_url: width: 150 }}" width="80" height="100" loading="lazy" alt="Miniatura">
              </div>
            {%- endfor -%}
          </div>
          
          <div class="iotw-featured-image">
            <img id="MainProductImage-{{ section.id }}" 
                 src="{{ product.featured_image | image_url: width: 1000 }}" 
                 width="{{ product.featured_image.width }}" 
                 height="{{ product.featured_image.height }}" 
                 alt="{{ product.title }}">
          </div>
        </div>

        <div class="iotw-content">
          <div class="iot-content-sticky">
            {%- if subtitle != blank -%}
              <p class="iotw-top-subtitle">{{ subtitle | upcase }}</p>
            {%- endif -%}
            
            <h1 class="iotw-prod-title">{{ product.title | upcase }}</h1>
            
            <div class="iotw-price-box">
              <span class="main-price">{{ current_variant.price | money }}</span>
            </div>

            {%- form 'product', product -%}
              <input type="hidden" name="id" value="{{ current_variant.id }}">
              
              <div class="iotw-selectors">
                {%- unless product.has_only_default_variant -%}
                  <label class="label-minimal">OPTIONS</label>
                  <select name="id" class="modern-select">
                    {%- for variant in product.variants -%}
                      <option value="{{ variant.id }}">{{ variant.title | upcase }}</option>
                    {%- endfor -%}
                  </select>
                {%- endunless -%}
              </div>

              <div class="iotw-actions-row">
                <button type="submit" class="btn-atc-clean" {% unless current_variant.available %}disabled{% endunless %}>
                  {% comment %} Texto alterado abaixo {% endcomment %}
                  <span>{% if current_variant.available %}EU QUERO{% else %}SOLD OUT{% endif %}</span>
                </button>
              </div>
            {%- endform -%}
          </div>
        </div>

      </div>
    {%- endif -%}
  </div>
</section>

<style>
/* FORÇANDO A FONTE INTER (HELVETICA MODERN) */

.iotw-section-minimal { 
  background: #ffffff; 
  padding: 80px 0; 
  color: #000;
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif !important;
}

.iotw-container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }

.iotw-header { margin-bottom: 60px; text-align: center; }
.iotw-title-clean { 
  font-size: {{ section.settings.title_size }}px !important; 
  letter-spacing: {{ section.settings.title_spacing }}px !important;
  font-weight: 200 !important; 
  text-transform: uppercase !important;
  font-family: 'Inter', sans-serif !important;
  margin: 0;
  line-height: 1.2;
}

.iotw-main-grid { display: grid; grid-template-columns: 1.1fr 0.9fr; gap: 60px; align-items: start; }

.iotw-visuals { display: flex; gap: 15px; }
.iotw-thumbnails-vertical { display: flex; flex-direction: column; gap: 10px; width: 70px; }
.thumb-wrapper { width: 70px; cursor: pointer; border-bottom: 1px solid transparent; transition: 0.3s; padding-bottom: 5px; }
.thumb-wrapper:hover { border-bottom-color: #000; }
.thumb-wrapper img { width: 100%; height: auto; object-fit: cover; }
.iotw-featured-image { flex-grow: 1; }
.iotw-featured-image img { width: 100%; height: auto; display: block; }

.iot-content-sticky { position: sticky; top: 40px; }
.iotw-top-subtitle { font-size: 10px; letter-spacing: 3px; color: #888; margin-bottom: 10px; font-weight: 400; }
.iotw-prod-title { font-size: 18px; font-weight: 400; letter-spacing: 2px; margin-bottom: 15px; font-family: 'Inter', sans-serif !important; }
.iotw-price-box { margin-bottom: 40px; font-size: 15px; font-weight: 300; letter-spacing: 1px; }

.label-minimal { font-size: 9px; letter-spacing: 2px; color: #000; display: block; margin-bottom: 10px; font-weight: 600; }
.modern-select { 
  width: 100%; 
  border: 1px solid #000; 
  padding: 12px; 
  font-size: 10px; 
  margin-bottom: 25px; 
  border-radius: 0; 
  background: transparent;
  letter-spacing: 1px;
  font-family: 'Inter', sans-serif !important;
}

.btn-atc-clean { 
  width: 100%; 
  background: #000; 
  color: #fff; 
  border: 1px solid #000; 
  padding: 18px; 
  font-size: 11px; 
  font-weight: 600; 
  letter-spacing: 3px; 
  cursor: pointer; 
  transition: all 0.3s ease; 
  font-family: 'Inter', sans-serif !important;
}
.btn-atc-clean:hover { background: #fff; color: #000; }

@media (max-width: 800px) {
  .iotw-main-grid { grid-template-columns: 1fr; gap: 40px; }
  .iotw-visuals { flex-direction: column-reverse; }
  .iotw-thumbnails-vertical { flex-direction: row; width: 100%; }
}
</style>

<script>
function switchImage(src, id) {
  const mainImg = document.getElementById('MainProductImage-' + id);
  if(mainImg) {
    mainImg.style.opacity = '0.3';
    setTimeout(() => {
      mainImg.src = src;
      mainImg.style.opacity = '1';
    }, 150);
  }
}
</script>

{% schema %}
{
  "name": "Item Semana Moderno",
  "settings": [
    {"type": "text", "id": "heading", "label": "Título", "default": "Item da semana"},
    {"type": "range", "id": "title_size", "min": 10, "max": 80, "step": 1, "unit": "px", "label": "Tamanho do Título", "default": 24},
    {"type": "range", "id": "title_spacing", "min": 0, "max": 30, "step": 1, "unit": "px", "label": "Espaçamento (Letter Spacing)", "default": 12},
    {"type": "product", "id": "product", "label": "Produto"},
    {"type": "text", "id": "subtitle", "label": "Subtítulo", "default": "COLLECTION 2026"}
  ],
  "presets": [{"name": "Item Semana Moderno"}]
}
{% endschema %}